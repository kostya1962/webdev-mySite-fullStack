# –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω–æ–π —Ç–æ–≤–∞—Ä–æ–≤

## –û–±–∑–æ—Ä —Ä–µ—à–µ–Ω–∏—è

–Ø —Å–æ–∑–¥–∞–ª –ø–æ–ª–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω–æ–π —Ç–æ–≤–∞—Ä–æ–≤ —Å frontend –∏ backend —á–∞—Å—Ç—è–º–∏. –í–æ—Ç –∫–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

### üì± Frontend —á–∞—Å—Ç—å

#### 1. **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (interfaces/cart.interface.ts)**
```typescript
- CartItem: —Ç–æ–≤–∞—Ä + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- Cart: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—Ä–∑–∏–Ω–µ
- AddToCartRequest/CartResponse: –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
```

#### 2. **Store (state/cart.state.ts)**
–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–æ—Ä–∑–∏–Ω—ã —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `addToCart(product, quantity)` - –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
- `updateQuantity(productId, quantity)` - –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `removeFromCart(productId)` - —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
- `clearCart()` - –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
- `getQuantity(productId)` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞
- `getTotalPrice()` - —Å—É–º–º–∞ –∫–æ—Ä–∑–∏–Ω—ã
- `getItemsCount()` - –≤—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤
- `restore(email)` - –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É —Å —Å–µ—Ä–≤–µ—Ä–∞

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º!**

#### 3. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç AddToCart (components/AddToCart.vue)**

–†–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö —Ä–µ–∂–∏–º–∞—Ö:

**–†–µ–∂–∏–º 1: –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É    ‚îÇ <- —á–µ—Ä–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞

**–†–µ–∂–∏–º 2: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –£–¥–∞–ª–∏—Ç—å  ‚îÇ  –°—á—ë—Ç—á–∏–∫     ‚îÇ –î–æ–±–∞–≤–∏—Ç—å ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```
–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è ‚Üí –≤–æ–∑–≤—Ä–∞—Ç –≤ —Ä–µ–∂–∏–º 1

### üîß Backend —á–∞—Å—Ç—å

#### 1. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (handlers/cart.go)**
```
POST   /api/cart        - –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
GET    /api/cart        - –ø–æ–ª—É—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
DELETE /api/cart        - —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
```

#### 2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `cart_items`:
- `user_id` - –∫—Ç–æ –¥–æ–±–∞–≤–∏–ª
- `product_id` - –∫–∞–∫–æ–π —Ç–æ–≤–∞—Ä
- `quantity` - —Å–∫–æ–ª—å–∫–æ —à—Ç—É–∫

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, /catalog/sup-[id].vue):

```vue
<template>
  <div class="product-page">
    <h1>{{ product.name }}</h1>
    <p>{{ product.price }} ‚ÇΩ</p>
    
    <!-- –í—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç -->
    <AddToCart :product="product" />
  </div>
</template>

<script setup lang="ts">
import type { Product } from '~/interfaces/product.interface'

// –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
const { data: product } = await useFetch<Product>(
  `/api/products/${id}`,
  { key: `product-${id}` }
)
</script>
```

### –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ—Ä–∑–∏–Ω–µ –≤ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:

```typescript
const cartStore = useCartStore()

// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ—Ä–∑–∏–Ω–µ
const itemsCount = cartStore.getItemsCount()
const totalPrice = cartStore.getTotalPrice()

// –í—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ
const items = cartStore.cartItems

// –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
cartStore.removeFromCart(productId)

// –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
cartStore.clearCart()
```

## üìä –ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ

### –õ–æ–∫–∞–ª—å–Ω–æ (–±—Ä–∞—É–∑–µ—Ä)
- Store –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `persist: true`
- –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ –¥–µ–ª–∞–µ—Ç—Å—è POST –∑–∞–ø—Ä–æ—Å
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–µ–ª–∞–µ—Ç—Å—è DELETE –∑–∞–ø—Ä–æ—Å
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `restore(email)`
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. Frontend - —É–∂–µ –≥–æ—Ç–æ–≤–æ!
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ store —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã, –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ.

### 2. Backend - –¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã

–§–∞–π–ª `main.go` —É–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω, –º–∞—Ä—à—Ä—É—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã:
```go
cart := api.Group("/cart")
cart.Post("/", handlers.AddToCart)
cart.Get("/", handlers.GetCart)
cart.Delete("/", handlers.RemoveFromCart)
```

### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É

–¢–∞–±–ª–∏—Ü–∞ `cart_items` –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–≤ —Ñ–∞–π–ª–µ `database/database.go` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ–¥).

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞ `database/migration_cart.sql`.

## üé® –°—Ç–∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è:
- –ß–µ—Ä–Ω–æ–π –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É"
- –°–µ—Ä–æ–π –∫–Ω–æ–ø–∫–∏ "–£–¥–∞–ª–∏—Ç—å"
- –ù–æ—Ä–º–∞–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å"
- –ì–∏–±–∫–æ–π –≤–µ—Ä—Å—Ç–∫–∏ —Å CounterFiled

–í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `--color-black`
- `--color-gray`

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
1. –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É"
   ‚Üì
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (authStore.token)
   ‚îú‚îÄ –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /auth/login
   ‚îî‚îÄ –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Üí –ø–æ–∫–∞–∑ —Å—á—ë—Ç—á–∏–∫–∞
   ‚Üì
3. –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤ CounterFiled
   ‚Üì
4. –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–î–æ–±–∞–≤–∏—Ç—å"
   ‚îú‚îÄ addToCart() ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ store
   ‚îú‚îÄ POST /api/cart ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   ‚Üì
5. –ö–æ—Ä–∑–∏–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞! üéâ
```

## üìù API

### POST /api/cart - –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
```json
{
  "email": "user@example.com",
  "productID": 1,
  "quantity": 2
}
```
–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "message": "Item added to cart"
}
```

### GET /api/cart?email=user@example.com - –ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
```json
[
  {
    "product": { /* –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ */ },
    "quantity": 2
  }
]
```

### DELETE /api/cart - –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
```json
{
  "email": "user@example.com",
  "productID": 1
}
```
–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "message": "Item removed from cart"
}
```

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏?
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ –∫–æ—Ä–∑–∏–Ω—É –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞:
```typescript
// –í middleware/auth.ts –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—á–∫–µ –≤—Ö–æ–¥–∞:
const cartStore = useCartStore()
const authStore = useAuthStore()

await cartStore.restore(authStore.email!)
```

### –¢–æ–≤–∞—Ä –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (`authStore.token` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. API –¥–æ—Å—Ç—É–ø–µ–Ω (`/api/cart` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å 200)
3. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ—Ç –æ—à–∏–±–æ–∫

### –¢–∞–±–ª–∏—Ü–∞ cart_items –Ω–µ —Å–æ–∑–¥–∞–Ω–∞?
–£–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª `app.db` –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä. –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## üéØ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å:
1. **–°–∫–∏–¥–∫–∏ –∏ –∞–∫—Ü–∏–∏** - –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å CounterFiled –¥–ª—è –≤–≤–æ–¥–∞ coupon –∫–æ–¥–∞
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –∑–∞–∫–∞–∑–æ–≤** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∑–∞–∫–∞–∑ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
3. **Analytics** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
4. **Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö –≤ –∫–æ—Ä–∑–∏–Ω–µ

